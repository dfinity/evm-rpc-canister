# Proposal to upgrade the EVM RPC canister

Repository: `https://github.com/dfinity/evm-rpc-canister.git`

Git hash: `67e78a627254a82abc729000ba75fe4f9f15b8b5`

New compressed Wasm hash: `5dbcce40bf3020cfc2d869373a8f3094785c80882fc4d52980814aa89abd541a`

Upgrade args hash: `6005397a2ddf2ee644ceaca123c9afbd2360f0644e7e5e6c4ac320a5f7bd4a82`

Target canister: `7hfb6-caaaa-aaaar-qadga-cai`

Previous EVM RPC proposal: https://dashboard.internetcomputer.org/proposal/138473

---

## Motivation

Upgrade the EVM RPC canister to the latest version [v2.6.0](https://github.com/dfinity/evm-rpc-canister/releases/tag/evm_rpc-v2.6.0),
which includes in particular the following changes:
* Add new `json_request` endpoint and deprecate existing `request` endpoint
* Add support for `root` and `cumulativeGasUsed` fields in `eth_getTransactionReceipt` response
* Remove `getMetrics` debugging endpoint
* Update `ic-cdk` to v0.18.7 and cleanup unused dependencies
* Add `err_max_response_size_exceeded` to Prometheus metrics

See the Gihub release [v2.6.0](https://github.com/dfinity/evm-rpc-canister/releases/tag/evm_rpc-v2.6.0) for more details.

## Release Notes

```
git log --format='%C(auto) %h %s' 864f38c9fd4be34387332fbb992368c343cabacc..67e78a627254a82abc729000ba75fe4f9f15b8b5 --
67e78a6 chore: release (#500)
0aa2b05 build: update `ic-cdk` to `v0.18.7` (#489)
4e3bb4b feat: add methods to modify RPC config to `RequestBuilder` (#494)
1882b6e refactor: remove remaining `ic-canister-log` usages (#496)
29e6ec5 fix: move non-alloy conversion from behind alloy feature (#493)
523cd8d refactor: remove unnecessary `#[candid_method]` annotations (#492)
26aaa2e build: cleanup unused dependencies (#491)
f977230 refactor: add `alloy` feature flag to `evm_rpc_client` (#484)
11a9f14 ci: check canister endpoints with `ic-wasm` (#488)
1b3dc31 build: update `dfx` to v0.29.0 (#490)
360a59c feat: add new `json_request` endpoint (#477)
f0f1047 fix: add `err_max_response_size_exceeded` to Prometheus metrics (#487)
b334321 refactor!: remove get metrics endpoint (#479)
6abdc30 refactor: remove blocking `EvmRpcSetup` setup (#478)
cb9a92d ci: add release and publish pipelines (#475)
2e1e6d4 feat: add client support for `eth_getTransactionReceipt` (#476)
c5e5dd5 feat: add `eth_sendRawTransaction` client support (#467)
21fd1f6 feat!: add support for `eth_getTransactionReceipt` response fields (#474)
bdccb9e feat: add client support for `eth_call` (#466)
195477b fix: typos in proposal filenames (#473)
6c04638 feat: add client support for `eth_getTransactionCount` (#465)
c2966fd chore: proposal to upgrade to v2.5.0 (#470)
 ```

## Upgrade args

```
git fetch
git checkout 67e78a627254a82abc729000ba75fe4f9f15b8b5
didc encode -d candid/evm_rpc.did -t '(InstallArgs)' '(record {})' | xxd -r -p | sha256sum
```

## Wasm Verification

Verify that the hash of the gzipped WASM matches the proposed hash.

```
git fetch
git checkout 67e78a627254a82abc729000ba75fe4f9f15b8b5
"./scripts/docker-build"
sha256sum ./evm_rpc.wasm.gz
```